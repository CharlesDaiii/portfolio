import{r as u,j as s}from"./jsx-runtime-Lfnj0zCF.js";import{u as $}from"./useInViewport-DazAZXCp.js";const I="_carouselContainer_6nwg9_1",x="_imageContainer_6nwg9_14",y="_slide_6nwg9_24",j="_active_6nwg9_36",N="_previous_6nwg9_42",A="_next_6nwg9_48",E="_leftArrow_6nwg9_54",S="_rightArrow_6nwg9_54",T="_thumbnailContainer_6nwg9_86",R="_thumbnail_6nwg9_86",k="_activeThumbnail_6nwg9_114",n={carouselContainer:I,imageContainer:x,slide:y,active:j,previous:N,next:A,leftArrow:E,rightArrow:S,thumbnailContainer:T,thumbnail:R,activeThumbnail:k},L=({images:e})=>{const[o,l]=u.useState(0),[h,d]=u.useState(null),[a,i]=u.useState(!0),g=u.useRef(null);$(g,!0),u.useEffect(()=>{if(!e.length)return;(async()=>{try{const r=[e[o],e[(o+1)%e.length]];await Promise.all(r.map(v=>new Promise((b,C)=>{const p=new Image;p.onload=b,p.onerror=C,p.src=_(v)}))),i(!1)}catch(r){console.error("Error preloading images:",r),i(!1)}})()},[o,e]);const _=t=>typeof t=="string"?t:t.compressed||t.src||t.url||"",w=u.useCallback(()=>{d("previous"),l(t=>t===0?e.length-1:t-1)},[e.length]),c=u.useCallback(()=>{d("next"),l(t=>t===e.length-1?0:t+1)},[e.length]),m=t=>t===o?`${n.slide} ${n.active}`:h==="next"&&t===(o-1+e.length)%e.length?`${n.slide} ${n.previous}`:h==="next"&&t===(o+1)%e.length?`${n.slide} ${n.next}`:h==="previous"&&t===(o-1+e.length)%e.length?`${n.slide} ${n.previous}`:h==="previous"&&t===(o+1)%e.length?`${n.slide} ${n.next}`:n.slide,f=t=>{console.error("Image failed to load:",t.target.src)};return s.jsxs("div",{ref:g,className:n.carouselContainer,children:[s.jsx("button",{className:n.leftArrow,onClick:w,"aria-label":"Previous image",children:"❮"}),s.jsx("button",{className:n.rightArrow,onClick:c,"aria-label":"Next image",children:"❯"}),s.jsx("div",{className:n.imageContainer,children:e.map((t,r)=>r===o||r===(o+1)%e.length||r===(o-1+e.length)%e.length?s.jsx("img",{src:_(t),alt:`Slide ${r+1}`,className:m(r),loading:r===o?"eager":"lazy",style:{opacity:a?0:1}},r):null)}),s.jsx("div",{className:n.thumbnailContainer,children:e.map((t,r)=>s.jsx("div",{className:`${n.thumbnail} ${r===o?n.activeThumbnail:""}`,onClick:()=>{d(r>o?"next":"previous"),l(r)},children:s.jsx("img",{src:_(t),alt:`Thumbnail ${r+1}`,loading:"lazy",onError:f})},r))})]})},D=async(e,o={})=>{const{maxWidth:l=1200,quality:h=90,format:d="webp"}=o,a=new Image,i=document.createElement("canvas"),g=i.getContext("2d");return new Promise((_,w)=>{a.onload=()=>{let c=a.width,m=a.height;c>l&&(m=m*l/c,c=l),i.width=c,i.height=m,g.imageSmoothingEnabled=!0,g.imageSmoothingQuality="high",g.drawImage(a,0,0,c,m);const f=i.toDataURL(`image/${d}`,h/100);_(f)},a.onerror=w,a.src=e})};export{L as I,D as o};
